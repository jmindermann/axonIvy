<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=iso-8859-1" http-equiv="content-type">
  <title>Migration Notes Designer</title>
  <link href="../shared/css/ivystyle-50.css" rel="stylesheet"
  type="text/css">
</head>

<body>

<div id="mainContent">

<div id="header">
<h1>Migration Notes for Xpert.ivy Designer 4.3 (Pilatus) ... 5.0 (Rothorn)</h1>
</div>

<div class="content">
<p>This document informs you in detail about <span
style="font-weight: bold;">incompatibilities that were introduced between
Xpert.ivy versions 4.3 (Pilatus) and 5.0 (Rothorn)</span> and tells you what
needs to be done to get your existing 4.3 projects working with Xpert.ivy
5.0.</p>
<ul style="margin-bottom: 30px;">
  <li><a href="#AutomaticConversion">Migration of projects</a></li>
  <li><a href="#webXml">Configuration in web.xml</a> 
  <li><a href="#validationProblems">Validation propblems</a> 
    <ul>
      <li><a href="#richDialogStartMethodValidation">Rich Dialog Start Method
        Validation</a></li>
      <li><a href="#htmlPageValidationScripts">Input Validation Scripts on HTML
        Pages</a></li>
    </ul>
  </li>
  <li><a href="#genericJavaList">Generic java.util.List</a></li>
  <li><a href="#32BitIdApiDeprecated">Integer (32 bit) identifier APIs
    deprecated</a></li>
  <li><a href="#svnUpgrade">Subclipse 1.8 and SVN 1.7</a></li>
</ul>
</div>
<a name="AutomaticConversion"></a> 

<h2>Migration of projects (project conversion)</h2>

<div class="content">
<p>Most of the incompatibilities can be resolved automatically by invoking the
<a href="ProjectConversion.html">project conversion</a> in the Designer. </p>

<p>However,�some issues may have to be fixed manually (after the automatic
conversion). Those are described in the next sections.<br>
</p>
</div>

<a name="webXml"></a> 
<h2>Configuration in web.xml</h2>
<div class="content">
<p>If you have modified the <i>web.xml</i> under <i>webapps/ivy/WEB-INF</i>,
please do not copy the whole content of your current web.xml to the new Designer.
Only copy parts you have modified, otherwise the Designer will not start correctly.</p>
</div>

<a name="validationProblems"></a> 

<h2>Validation problems</h2>

<div class="content">
<p>Xpert.Ivy 5 (Rothorn) has a wide set of built in validations, that take care
about the integrity of your process models. It could be that the Problems View
shows more errors and warnings than in Xpert.ivy 4.3 (Pilatus) as additional
validation rules have been integrated into the latest Xpert.ivy Designer. <br>
<br>
Errors in the process should be fixed manually. As it is very likely that the
execution of the affected process element will fail at runtime. </p>
</div>
<a name="richDialogStartMethodValidation"></a> 

<h3>Rich Dialog Start Method Validation</h3>

<div class="content">
<p>The validation now adds an error to the Rich Dialog Logic for each declared
Rich Dialog start method that does not have an implementation. This can lead to
new errors, because until now it was allowed to leave the automatically added
default start method <code>start():void</code> unimplemented. </p>

<p>This is no longer allowed. However, if the default start method is not
needed, it is now allowed to delete it. You should therefore delete all unused
default start methods to resolve the shown errors.</p>

<p>At runtime nothing has changed. The execution of an unimplemented default
start method still adds errors to the log and the correct lifecycle completion
of the Rich Dialog is still not guaranteed for that case.</p>

<p><img alt="Validation message of unimplemented default start method"
src="images/4.4_validation_unimplemented_default_start.png" height="222"
width="799"> </p>
</div>
<a name="htmlPageValidationScripts"></a> 

<h3>Input Validation Scripts on Html Pages</h3>

<div class="content">
<p>The validation now reports a number of errors concerning the javascript
files used for input validation on Html Forms.</p>

<p><img style="width: 928px; height: 286px;"
alt="Validation error messages concerning the jscript input validation methods"
src="images/validation_errors_in_jscript_validation_files.png"> </p>

<p>This is because the validation rules are now more strict thena they used to
be. However, if you don't fix the javascripts, the Html forms with the input
validation still work with no limitation, despite the validation error
messages.</p>

<p>If you want to get rid of the this validation errors, you have to fix a
single line in each jscript file in the folder <span
style="font-weight: bold;">yourProject/webContent/scripts/validation</span> </p>
Just replace the html comment tags <code>&lt;!-- ... --&gt;</code> in the first
line with comment delimiters <code>/* ... */</code> and save the file.�Or as a
simple alternative copy the validation javascript files from an actual new
project into your project to replace the wrong script. 

<p>Example of the fixed line in the file _Empty.js:<br>
<img alt="Fixed comment tags in a jscript validation file"
src="images/fixed_jscript_validation_file.png"
style="border: 1px solid; width: 538px; height: 53px;"> </p>
</div>
<a name="genericJavaList"></a> 

<h2>Generic java.util.List</h2>

<div class="content">
<p>The support for generic instances of <code>java.util.List</code> has been
enhanced. IvyScript now evaluates the member type of a
<code>java.util.List&lt;?&gt;</code> implementation (see <a
href="../newAndNoteworthy/NewAndNoteworthyDesigner.html">NewAndNoteworthy
Designer</a>). </p>

<p>Java instances of <code>java.util.List</code> which had generic type
information lost their member type when they were used with IvyScript before
5.0 and were treated as instances of <code>List&lt;Object&gt;</code> .
Therefore IvyScript allowed to </p>
<ul>
  <li>add objects to a list, which did not have the required member type</li>
  <li>assign <code>List&lt;SomeType&gt;</code> to a list even if
    <code>SomeType</code> was not the generic type of the list</li>
</ul>

<p>For example, the parked work tasks of a session have the type
<code>List&lt;ITask&gt;</code> . Using the session API, the following
assignment was possible:
<code>ivy.session.findParkedWorkTasks(0,1).add("iAmNotATask");</code> </p>

<p>With Xpert.ivy 5.0 this bug has been fixed and untyped assignments of this
kind are no longer tolerated. If your code contains assignments as shown above,
Validation will now show an error marker for it at design time and exceptions
will be thrown at runtime.</p>

<p>If you have used <code>java.util.List</code> instances in IvyScript you
should check your project for error markers before you execute it on a
Xpert.ivy 5.0 server. </p>
</div>
<a name="32BitIdApiDeprecated"></a> 

<h2>Integer (32 Bit) Identifier APIs deprecated</h2>

<div class="content">
<p>All APIs that use Integer or int (32 bit) identifiers for objects that are
stored in the system database are deprecated now. The deprecated APIs will
still work at least as long as the identifier is not larger than 2'147'483'648.
For larger identifiers a NumberFormatException will be thrown.</p>

<p>However, we strongly recommend to use the new APIs that uses Long or long
(64 bit) identifiers. The APIs of the following packages are affected:</p>
<ul>
  <li>ch.ivyteam.ivy.application.*</li>
  <li>ch.ivyteam.ivy.security.*</li>
  <li>ch.ivyteam.ivy.workflow.*</li>
  <li>ch.ivyteam.ivy.workflow.query.*</li>
</ul>

<p>The most noticable deprecated API is the method getIdentifier():int on
interfaces like ITask, ICase, IUser, IRole, etc. Use the new method
getId():long instead.</p>
</div>
<a name="svnUpgrade"></a> 

<h2>Subclipse 1.8 and SVN 1.7</h2>

<div class="content">
<p>The Subclipse plugin has been updated to version 1.8 which uses Subversion
1.7 as underlying base. Since Subversion 1.7 has a new working copy format, an
upgrade of the working copy is required.</p>

<p>If you want to commit from an SVN 1.6 working copy the commit fails with the
following error:</p>

<p><img alt="SVN working copy update required"
src="images/44_SvnTooOldException.png"> </p>

<p>To upgrade an existing working copy of a project in the designer execute the
following steps:</p>
<ol>
  <li>Right-click on the project</li>
  <li>Click on Team/Upgrade</li>
  <li>Confirm the Upgrade</li>
</ol>

<p>If you use other SVN clients like Tortoise SVN these clients have to be
updated as well to a version which supports SVN 1.7.</p>
</div>
</div>
</body>
</html>
